/*! 
 Build based on gin-vue-admin 
 Time : 1646814142000 */
!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=document.createElement("style");i.innerHTML=".image-uploader[data-v-752d062a]{border:1px dashed #d9d9d9;width:180px;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.image-uploader[data-v-752d062a]{border-color:#409eff}.image-uploader-icon[data-v-752d062a]{font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.image[data-v-752d062a]{width:178px;height:178px;display:block}\n",document.head.appendChild(i),System.register(["../gva/gin-vue-admin-index-legacy.1646814142000.js","./gin-vue-admin-vendor-legacy.1646814142000.js"],(function(i){"use strict";var n,a,r,o,d,l,u,c,s,h,f;return{setters:[function(e){n=e._,a=e.u},function(e){r=e.r,o=e.i,d=e.o,l=e.j,u=e.k,c=e.t,s=e.x,h=e.A,f=e.d}],execute:function(){i("d",(function(e,t){var i=new Image;i.setAttribute("crossOrigin","anonymous"),i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0,i.width,i.height);var n=e.toDataURL("image/png"),a=document.createElement("a"),r=new MouseEvent("click");a.download=t||"photo",a.href=n,a.dispatchEvent(r)},i.src=e}));var p=function(){function i(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1920;e(this,i),this.file=t,this.fileSize=n,this.maxWH=a}var n,a,r;return n=i,(a=[{key:"compress",value:function(){var e=this,t=this.file.type,i=this.file.size/1024;return new Promise((function(n){var a=new FileReader;a.readAsDataURL(e.file),a.onload=function(){var r=document.createElement("canvas"),o=document.createElement("img");o.src=a.result,o.onload=function(){var a=r.getContext("2d"),d=e.dWH(o.width,o.height,e.maxWH);r.width=d.width,r.height=d.height,a.clearRect(0,0,r.width,r.height),a.drawImage(o,0,0,r.width,r.height);var l=r.toDataURL(t,.9),u=e.fileSizeKB(l);u>e.fileSize&&console.log("图片尺寸太大!"+i+" >> "+u);var c=e.dataURLtoBlob(l,t),s=new File([c],e.file.name);n(s)}}}))}},{key:"dWH",value:function(e,t,i){var n={width:e,height:t};return Math.max(e,t)>i?e>t?(n.width=i,n.height=Math.round(t*(i/e)),n):(n.height=i,n.width=Math.round(e*(i/t)),n):n}},{key:"fileSizeKB",value:function(e){return Math.round(3*e.split(",")[1].length/4/1024)}},{key:"dataURLtoBlob",value:function(e,t){for(var i=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(i.length),r=new Uint8Array(a),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return t&&(n=t),new Blob([a],{type:n,lastModifiedDate:new Date})}}])&&t(n.prototype,a),r&&t(n,r),Object.defineProperty(n,"prototype",{writable:!1}),i}(),g=h("点击上传"),m={name:"UploadImage",methods:{}};i("U",n(Object.assign(m,{props:{imageUrl:{type:String,default:""},fileSize:{type:Number,default:2048},maxWH:{type:Number,default:1920}},emits:["on-success"],setup:function(e,t){var i=t.emit,n=e,h=r("/api"),m=a(),v=function(e){var t="image/jpeg"===e.type,i="image/png"===e.type;if(!t&&!i)return f.error("上传头像图片只能是 jpg或png 格式!"),!1;var a=e.size/1024<n.fileSize;return a||new p(e,n.fileSize,n.maxWH).compress()},w=function(e){var t=e.data;t.file&&i("on-success",t.file.url)};return function(e,t){var i=o("el-button"),n=o("el-upload");return d(),l("div",null,[u(n,{action:"".concat(h.value,"/fileUploadAndDownload/upload"),headers:{"x-token":s(m).token},"show-file-list":!1,"on-success":w,"before-upload":v,multiple:!1},{default:c((function(){return[u(i,{size:"mini",type:"primary"},{default:c((function(){return[g]})),_:1})]})),_:1},8,["action","headers"])])}}}),[["__scopeId","data-v-752d062a"]]))}}}))}();
